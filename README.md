# Урок 26. Докер. Домашнее задание

Привет, это Сережа! Сегодня мы закрепим знание о докере и развернем ваш проект на виртуальной машине.

![Снимок экрана 2022-01-12 в 18.10.43.png](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/f71a3938-e16d-4ec7-9887-4ce810d0fd41/Снимок_экрана_2022-01-12_в_18.10.43.png)

Если просто пользоваться командой "apt install docker-compose", может установиться не самая новая версия. Чтобы все работало как в уроке, лучше поставить 1.29+. Скачать с репозитория, дать права и переместить в папку с бинарниками.

### Задание

Необходимо сделать автоматическое развертывание вашего проекта (на Django или Flask из предыдущих курсов) на виртуальную машину.

### Как выполнять задание

**Шаг 1** 

**Шаг 2** 

**Шаг 3** 

**Шаг 4** 

**Шаг 5** 

Создать файл Dockerfile для своего приложения

Создать файл docker-compose.yaml, где описываются все контейнеры в вашем приложении.

Создать ssh–пользователя для развертывания приложения

Установить docker на виртуальной машине

- Создать в проекте файл .github/workflows/action.yaml, в котором описать действия:
    1. Сборка образа
    2. Отправка образа в dockerhub
    3. Создание файлов конфигурации (docker-compose.yaml и файл для приложения)
    4. Копирование файлов конфигурации на сервер
    5. Запуск docker-compose

### Как сдавать задание

Прикрепите в поле “домашнее задание” 

1. Ссылку на репозиторий
2. Ссылку на сам проект (доменное имя)
3. Предоставить доступ к машине через ssh
- по алгоритму добавления пользователя:
    
    (Внимание, делать нужно только если вы этого не делали в предыдущем ДЗ)
    
    1. ssh <user>@<ip>
    2. adduser skypro
        1. Сохраняем <пароль> (нужно поставить сложный)
        2. Остальные настройки оставляем по умолчанию
    3. usermod -aG sudo skypro
    4. vim /etc/ssh/sshd_config
        1. Изменяем строчку “PasswordAuthentication no” на “PasswordAuthentication yes”
    5. sudo service ssh restart
    6. присылаем ip адрес, имя пользователя (skypro), и пароль проверяющему

Описание всего процесса указано в шпаргалке урока 26.

**Необязательное задание со звездочкой:**

Добавить прогон линтера (flake8, pylint или black) в один из шагов CI/CD

Для этого надо будет:

- добавить в requirements.txt библиотеку с линтером
- настроить для него конфигурацию
- запустить команду линтера в github actions

### Проверьте себя

- [ ]  По указанному адресу ваше приложение доступно
- [ ]  Все примеры запросов корректно отрабатывают и показывают, что ваше приложение работает с БД (например, есть метод создания пользователя и списка пользователей. после создания пользователя, запрос на список его выводит)
- [ ]  Процесс вашего проекта запущен через docker-compose
- [ ]  Файл actions.yaml выполнен верно
- [ ]  Шаги внутри workflow выполнены верно
